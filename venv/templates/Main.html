<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Pico.io</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="shortcut icon" href="/static/favicon.ico">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>

    /**
     * shows the user profile if the user is logged in
     */
    function getProfile() {
        $('#homeBtn').removeClass('active');
        $('#profileBtn').addClass("active");
        $('#highScoreBtn').removeClass("active");
        s = `
        <h1 style="padding-left: 30px;">
            Currently not logged in.
        </h1>
        `
        document.getElementById('curr_disp').innerHTML = s;
    }
    /**
     * Shows the high scores
     */
    function showHighScores() {
        $('#homeBtn').removeClass('active');
        $('#profileBtn').removeClass("active");
        $('#highScoreBtn').addClass("active");
        s = `
        <h1 style="padding-left: 30px;">High Scores</h1>

        <ul class = 'list-group' style='padding-left: 30px; padding-right: 30px'>
        {% for game in games %}
            <li class = 'list-group-item clearfix'>
                <h1>  Number {{ game[0] +1 }}: {{game[1]}} Points.
                    <a href="{{ url_for('profile', profile_name='foobar') }}">
                    <input type='button' class='btn btn-default pull-right' value='See Profile'></input>
                    </a>
                </h1>
            </li>
        {% endfor %}
        </ul>
        `;
        document.getElementById('curr_disp').innerHTML = s;
    }

    function showMore() {
        showHome(true);
    }
    function showLess() {
        showHome(false);
    }

    /**
     * show the home screen (all of the games available)
     */
    function showHome(showAll = false) {
        $('#homeBtn').addClass('active');
        $('#profileBtn').removeClass("active");
        $('#highScoreBtn').removeClass("active");
        /* TODO: fix redundancy */
        if (showAll == false) {
            document.getElementById('curr_disp').innerHTML = `
            <input type="button" class="btn btn-primary" value="Reload Games" onclick="reloadGameList();" id="reloadGames"></input>
            <ul class = 'list-group' style='padding-left: 30px; padding-right: 30px'>
            {% for game in games %}
                {% if game[0] < 5 %}
                    <li class = 'list-group-item clearfix'>
                        {% if game[1] == 1 %}
                            <h1>  Game Number {{ game[0] +1 }}: {{game[1]}} player in game.
                        {% else %}
                            <h1>  Game Number {{ game[0] +1 }}: {{game[1]}} players in game.
                        {% endif %}
                            {% if game[1] == 2 %}
                                <input type='button' class='btn btn-default pull-right' value='Full' onclick="showGameFull()"></input>
                            {% else %}
                                <a href = '/game/{{game[0]}}'>
                                    <input type='button' class='btn btn-success pull-right' value='Join Game'> </input>
                                </a>
                            {% endif %}
                        </h1>
                    </li>
                {% else %}
                    {% if game[0] == 5 %}
                        <li class = 'list-group-item clearfix'>
                            <center><span onclick="showMore();"><h1>...</h1></span></center>
                        </li>
                    {% endif %}
                {% endif %}
            {% endfor %}
            </ul>
            `
        } else {
            document.getElementById('curr_disp').innerHTML = `
            <input type="button" class="btn btn-primary" value="Reload Games" onclick="reloadGameList();" id="reloadGames"></input>
            <ul class = 'list-group' style='padding-left: 30px; padding-right: 30px'>
            {% for game in games %}
                    <li class = 'list-group-item clearfix'>
                        {% if game[1] == 1 %}
                            <h1>  Game Number {{ game[0] +1 }}: {{game[1]}} player in game.
                        {% else %}
                            <h1>  Game Number {{ game[0] +1 }}: {{game[1]}} players in game.
                        {% endif %}
                            {% if game[1] == 2 %}
                                <input type='button' class='btn btn-default pull-right' value='Full' onclick="showGameFull()"></input>
                            {% else %}
                                <a href = '/game/{{game[0]}}'>
                                    <input type='button' class='btn btn-success pull-right' value='Join Game'> </input>
                                </a>
                            {% endif %}
                        </h1>
                    </li>
            {% endfor %}
                <li class = 'list-group-item clearfix'>
                    <center><span onclick="showLess();"><h1>^</h1></span></center>
                </li>
            </ul>
            `
        }

        document.getElementById('curr_disp').innerHTML +=
        `<center style = "padding-left: 200px; padding-right: 200px">
        <h3>
            Rules:
        </h3>
            <h4>
                You will compete against another player to cover the most ground possible.
                Control your Picobot by changing its rules.
                When you drive over a square, it will change colors to show you control it.
                At the end of the time, whoever has the most space covered wins.
            </h4>
        </center>

        <center>
            <input id="createGameBtn" style="margin-left: 30px;" type="button" class="btn btn-success" value="Create New Game" onclick="createNewGame(); showGameCreate()"></input>
            <input id="quickJoin" style="margin-left: 5px;" type="button" class="btn btn-success" value="Quick Join" onclick="quickJoin()"></input>
            </center>

        <div class="alert alert-info" id="new_game">
            <strong id="alert_text"></strong>
            <a href="#_" class="close" aria-label="close" onclick="$('#new_game').fadeOut(500, show_game_done)">&times</a>
        </div>

        <div class="alert alert-danger" id="join_full">
            <strong id="alert_text_2"></strong>
            <a href="#_" class="close" aria-label="close" onclick="$('#join_full').fadeOut(500)">&times</a>
        </div>`
    }
    $( document ).ready(function() {
        showHome();
    });
    </script>
</head>
<body>

    <title> Picoio </title>

    <div class="modal fade" id="loginModal">
        <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span>&times;</span>
                </button>
                <p> Login to Picoio </p>
            </div>
            <div class="modal-body">
                <p>
                    Username:
                    <div class="form-group">
                        <input class="form-control" id="inputdefault" type="text">
                    </div>
                </p>
                <p>
                    Password:
                    <div class="form-group">
                        <input class="form-control" id="inputdefault" type="password">
                    </div>
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary"> Login </button>
                <button type="button" class="btn btn-secondary" > Register </button>
            </div>
            </div>
        </div>
    </div>

    <nav class="navbar navbar-inverse" id="login_bar">
        <ul class="nav navbar-nav">
            <li id="homeBtn" class="active"><a href="#" onclick="showHome();">Home</a></li>
            <li id="profileBtn"><a href="#" onclick="getProfile();">Profile</a></li>
            <li id="highScoreBtn"><a href="#" onclick="showHighScores();">High Scores</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="#" style="margin-right: 20px;" data-toggle="modal" data-target="#loginModal">Login</a></li>
        </ul>
    </nav>

    <header>
        <h1>
            <center>
                <img src="/static/picoblue.png">
                Multiplayer Picobot Game - Lobby
                <img src="/static/picored.png">
            </center>
        </h1>
    </header>

    <div id="curr_disp">
    </div>

    <style>
        #new_game, #join_full {
            display: none;
            margin-top: 30px;
            width: 90%;
            position: relative;
            left: 5%;
        }
        #reloadGames {
            margin-left: 30px;
            margin-bottom: 8px;
        }
        #login_bar {
            border-radius: 0px;
        }
        body {
            padding-bottom: 30px;
        }
    </style>
    <!-- display:none; padding-bottom: 30px;  -->
    <script src="/static/Lobby.js"></script>
</body>
</html>

